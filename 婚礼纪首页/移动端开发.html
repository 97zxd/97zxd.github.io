<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./iconfont/iconfont.css">
    <script src="iscroll.Veb.js"></script>
    <script src="zepto.js"></script>
    <link rel="stylesheet" href="hunliji.css">
    <!-- 实际宽度750px 
    font_size: 100*100vw/750=13.33vw
    页面内的元素均按自己实际长宽的百分之一来，写单位为rem-->
</head>

<body>

    <div class="header w">
        <p>郑州</p>
        <span class="iconfont">&#xe602;</span>
        <div class="ipt">
            <input type="text">
            <a href="">
                <span class="iconfont">&#xe6b6;</span>
            </a>
        </div>
        <a href=""><span class="iconfont liuyan">&#xe603;</span></a>
        <a href=""><span class="iconfont gouwuche">&#xe6de;</span></a>
    </div>
    <main id="content_view">
        <div id="view_box">
            <div class="tip">下拉刷新</div>
            <div class="w" id="banner">
                <div id="banner_box">
                    <img src="images/index-banner01.jpg" alt="">
                    <img src="images/index-banner02.jpg" alt="">
                    <img src="images/index-banner03.jpg" alt="">
                </div>
                <div id="banner_btn">

                </div>
            </div>
            <div class="nav w">
                <ul class="nav_box">
                    <li>
                        <img src="images/index-list01.jpg" alt="">
                        <p>找商家</p>
                    </li>
                    <li>
                        <img src="images/index-list02.jpg" alt="">
                        <p>备婚清单</p>
                    </li>
                    <li>
                        <img src="images/index-list03.jpg" alt="">
                        <p>电子请帖</p>
                    </li>
                    <li>
                        <img src="images/index-list04.jpg" alt="">
                        <p>结婚任务</p>
                    </li>
                </ul>
            </div>
            <div class="content w">
                <div class="content_left">
                    <p class="p1">婚品采购</p>
                    <p class="p2">婚纱礼服 喜糖 请帖</p>
                    <img src="images/index-pic01.jpg" alt="">
                </div>
                <div class="content_right">
                    <div class="top">
                        <img src="images/index-pic02.jpg" alt="">
                        <div>
                            <p class="p1" style="color:#f06d1e;">婚车租赁</p>
                            <p class="p2">全城最低 买贵退钱</p>
                        </div>
                    </div>
                    <div class="bottom">
                        <img src="images/index-pic03.jpg" alt="">
                        <div>
                            <p class="p1" style="color:#169bd5;">全球旅拍</p>
                            <p class="p2">机票+酒店+拍摄</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="img w">
                <img src="images/index-sea.jpg" alt="">
            </div>
            <div class="box w">
                <div class="box_top">
                    <div class="box_top_touxiang"><img src="images/index-tou01.jpg" alt=""></div>
                    <div class="name">爱燕子婚纱摄影工作室</div>
                    <div class="gongneng">婚纱摄影</div>
                    <div class="guanzhu">
                        <p>
                            <span class="iconfont" style="font-size:0.26rem;">&#xe6a8;</span>
                            关注
                        </p>
                    </div>
                </div>
                <p class="info">唯美浪漫婚纱照6套服装造型 内景+外景多场景</p>
                <div class="img w">
                    <img src="images/index-sea2.jpg" alt="">
                </div>
                <div class="price w">
                    <div class="price_box">
                        <p class="p1">￥ 3988 <span> 8888</span></p>
                        <p class="p2">立即抢</p>
                    </div>
                </div>
            </div>
            <div class="biaoqian w">
                <p class="p1">
                    <span class="iconfont">&#xe61c;</span>
                    小清新婚纱照 跟拍
                </p>
                <p class="p2">
                    <span class="iconfont">&#xe6dc;</span>
                    2073</p>
            </div>
            <div class="box w">
                <div class="box_top">
                    <div class="box_top_touxiang"><img src="images/index-tou02.jpg" alt=""></div>
                    <div class="name">郑州丽致龙婚纱摄影</div>
                    <div class="gongneng">婚纱摄影</div>
                    <div class="guanzhu">
                        <p>
                            <span class="iconfont" style="font-size:0.26rem;">&#xe6a8;</span>
                            关注
                        </p>
                    </div>
                </div>
                <p class="info">最新客片，美懵了</p>
                <div class="img smallimg w">
                    <img src="images/index-photo01.jpg" alt="">
                    <img src="images/index-photo02.jpg" alt="">
                </div>
            </div>
            <div class="biaoqian w">
                <p class="p2">
                    <span class="iconfont">&#xe6dc;</span>
                    2073</p>
            </div>
        </div>
    </main>
    <div class="footer w">
        <div class="footer_li" style="margin-left:0rem;">
            <a href="index.html" style="color:#ff5c5c;">
                <div class="iconfont" style="font-size:0.48rem;">&#xe608;</div>
                <p>首页</p>
            </a>
        </div>
        <div class="footer_li">
            <a href="hunli_h.html">
                <div class="iconfont" style="font-size:0.4rem;">&#xe64c;</div>
                <p>分类</p>
            </a>
        </div>
        <div class="footer_li">
            <a href="hunsha18.html">
                <div class="iconfont" style="font-size:0.4rem;">&#xe603;</div>
                <p>新娘说</p>
            </a>
        </div>
        <div class="footer_li">
            <a href="hunsha19.html">
                <div class="iconfont" style="font-size:0.52rem;">&#xe60a;</div>
                <p>工具</p>
            </a>
        </div>
        <div class="footer_li">
            <a href="hunsha20.html">
                <div class="iconfont" style="font-size:0.45rem;margin-top:0.08rem;">&#xe64d;</div>
                <p style="margin-top:0.14rem;">我的</p>
            </a>
        </div>

    </div>
</body>
<script>

    for (var i = 0; i < banner_box.children.length; i++) {
        banner_btn.innerHTML += "<div></div>";
    }
    banner_btn.children[0].style.backgroundColor = "rgba(0,0,0,0.8)";
    var firstImg = banner_box.children[0];
    var lastImg = banner_box.children[banner_box.children.length - 1];
    banner_box.appendChild(firstImg.cloneNode());
    banner_box.insertBefore(lastImg.cloneNode(), firstImg);

    var length = banner_box.children.length;
    banner_box.style.width = 7.5 * length + "rem";

    var x = 0;
    var isc = new iScroll("banner", {
        // 开启元素捕捉
        snap: true,
        // 关闭惯性
        momentum: false,
        // 隐藏水平滚动条
        hScrollbar: false,
        // 设置切换阀值
        snapThreshold: 50,

        onBeforeScrollStart: function (e) {
            e.preventDefault();
            e.stopPropagation();
        },
        // 滚动结束回调
        onScrollEnd: function () {
            // 滚动结束获取当前页码
            console.log(this.currPageX)
            // 滚动到假的第一张 瞬间到达真的第一张
            if (this.currPageX == banner_box.children.length - 1) {
                this.scrollToPage(1, 0, 0);
            }
            // 滚动到假的最后第一张 瞬间到达真的最后一张
            if (this.currPageX == 0) {
                this.scrollToPage(banner_btn.children.length, 0, 0);
            }

            // 根据currPageX对应小圆点
            banner_btn.children[x].style.backgroundColor = "rgba(255,255,255,0.8)";
            banner_btn.children[this.currPageX - 1].style.backgroundColor = "rgba(0,0,0,0.8)";
            x = this.currPageX - 1;
        }
    })

    // 默认滚动到第二张  第二张才是真正的第一张
    isc.scrollToPage(1, 0, 0);

    //页面整体
    // console.log("ok");
    var isc_content = new iScroll("content_view", {
        // momentum:false,//关闭惯性
        topOffset: 40,
        y: -40,
        onScrollMove: function () {
            if (this.y > 100) {

                // 设置回弹点  顶部回弹位置
                this.minScrollY = 0;
                console.log("ok");
                $(".tip").html("松开立即刷新")
            } else {
                // 设置回弹点  顶部回弹位置
                this.minScrollY = -40;
                $(".tip").html("下拉刷新")
            }

        },

        onScrollEnd: function () {
            if (this.minScrollY == 0) {
                console.log("haha");
                //滚动结束时 发现minScrollY为0 符合刷新条件
                $(".tip").html("正在刷新中...");
                // 重新请求数据
                setTimeout(function () {

                    // // 重新计算尺寸
                    isc_content.refresh();
                    // // 恢复成初始状态
                    $(".tip").html("下拉刷新");
                }, 2000)
            }
            // isc_content.refresh();
        }

    })
    // isc_content.refresh();




</script>

</html>